services:
  - type: web
    name: datamimic-api
    env: node
    plan: free
    branch: main
    buildCommand: "npm install --include=dev && npm run build"
    startCommand: "npm start"
    autoDeploy: true
    healthCheckPath: "/api/datasets"
    envVars:
      - key: NODE_ENV
        value: production
      - key: NPM_CONFIG_PRODUCTION
        value: "false"
      - key: PORT
        value: 10000
      - key: ALLOWED_ORIGIN
        value: https://data-mimic.vercel.app
      # Optional: persistent storage
      - key: DATABASE_URL
        sync: false
      # Optional: prefer JS fallback in serverless environments
      - key: PYTHON_BIN
        value: ""
